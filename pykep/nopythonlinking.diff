diff --git a/PyKEP/CMakeLists.txt b/PyKEP/CMakeLists.txt
index 4037835..6bbf2c0 100644
--- a/PyKEP/CMakeLists.txt
+++ b/PyKEP/CMakeLists.txt
@@ -11,8 +11,13 @@ MACRO(PYTHON_CPPMODULE arg1)
 		SET_TARGET_PROPERTIES(${arg1} PROPERTIES SUFFIX ".pyd")
 	ELSEIF(SOEXTENSION)
 		SET_TARGET_PROPERTIES(${arg1} PROPERTIES SUFFIX ".so")
-	ENDIF(PYDEXTENSION)
-	TARGET_LINK_LIBRARIES(${arg1} ${LIBRARIES_4_PYTHON_MODULES} ${PYTHON_LIBRARY} ${ARGN})
+	ENDIF()
+	TARGET_LINK_LIBRARIES(${arg1} ${LIBRARIES_4_PYTHON_MODULES} ${ARGN})
+	IF(WIN32)
+		TARGET_LINK_LIBRARIES(${arg1} ${PYTHON})
+	ELSEIF(${CMAKE_SYSTEM_NAME} MATCHES "Darwin")
+		set (CMAKE_SHARED_LINKER_FLAGS "-undefined dynamic_lookup")
+	ENDIF()
 	STRING(REGEX REPLACE "^_" "" DIR_ARG ${arg1})
 	INSTALL(TARGETS ${arg1}
                 RUNTIME DESTINATION ${PYKEP_INSTALL_PATH}/${DIR_ARG}
